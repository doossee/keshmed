import{c as S,g as O}from"./unhead-98eeea87.js";import{n as $,v as I,u as M,l as D,r as A,q as R,w as U,s as W,a as B,t as N,x as q}from"./@vue-94c9cb71.js";function F(e){return Array.isArray(e)?e:[e]}const K=["title","titleTemplate","script","style","noscript"],T=["base","meta","link","style","script","noscript"],V=["title","titleTemplate","templateParams","base","htmlAttrs","bodyAttrs","meta","link","style","script","noscript"],k=["base","title","titleTemplate","bodyAttrs","htmlAttrs","templateParams"],x=["tagPosition","tagPriority","tagDuplicateStrategy","children","innerHTML","textContent","processTemplateParams"],fe=typeof window<"u";function de(e){return e}function G(e){let n=9;for(let t=0;t<e.length;)n=Math.imul(n^e.charCodeAt(t++),9**9);return((n^n>>>9)+65536).toString(16).substring(1,8).toLowerCase()}function H(e){return e._h||G(e._d?e._d:`${e.tag}:${e.textContent||e.innerHTML||""}:${Object.entries(e.props).map(([n,t])=>`${n}:${String(t)}`).join(",")}`)}function J(e,n){const{props:t,tag:o}=e;if(k.includes(o))return o;if(o==="link"&&t.rel==="canonical")return"canonical";if(t.charset)return"charset";const r=["id"];o==="meta"&&r.push("name","property","http-equiv");for(const s of r)if(typeof t[s]<"u"){const c=String(t[s]);return n&&!n(c)?!1:`${o}:${s}:${c}`}return!1}function ue(e,n){return e==null?n||null:typeof e=="function"?e(n):e}async function z(e,n,t){const o={tag:e,props:await j(typeof n=="object"&&typeof n!="function"&&!(n instanceof Promise)?{...n}:{[["script","noscript","style"].includes(e)?"innerHTML":"textContent"]:n},["templateParams","titleTemplate"].includes(e))};return x.forEach(r=>{const s=typeof o.props[r]<"u"?o.props[r]:t[r];typeof s<"u"&&((!["innerHTML","textContent","children"].includes(r)||K.includes(o.tag))&&(o[r==="children"?"innerHTML":r]=s),delete o.props[r])}),o.props.body&&(o.tagPosition="bodyClose",delete o.props.body),o.tag==="script"&&typeof o.innerHTML=="object"&&(o.innerHTML=JSON.stringify(o.innerHTML),o.props.type=o.props.type||"application/json"),Array.isArray(o.props.content)?o.props.content.map(r=>({...o,props:{...o.props,content:r}})):o}function Q(e){return typeof e=="object"&&!Array.isArray(e)&&(e=Object.keys(e).filter(n=>e[n])),(Array.isArray(e)?e.join(" "):e).split(" ").filter(n=>n.trim()).filter(Boolean).join(" ")}async function j(e,n){for(const t of Object.keys(e)){if(t==="class"){e[t]=Q(e[t]);continue}if(e[t]instanceof Promise&&(e[t]=await e[t]),!n&&!x.includes(t)){const o=String(e[t]),r=t.startsWith("data-");o==="true"||o===""?e[t]=r?"true":!0:e[t]||(r&&o==="false"?e[t]="false":delete e[t])}}return e}const X=10;async function pe(e){const n=[];return Object.entries(e.resolvedInput).filter(([t,o])=>typeof o<"u"&&V.includes(t)).forEach(([t,o])=>{const r=F(o);n.push(...r.map(s=>z(t,s,e)).flat())}),(await Promise.all(n)).flat().filter(Boolean).map((t,o)=>(t._e=e._i,e.mode&&(t._m=e.mode),t._p=(e._i<<X)+o,t))}const P={base:-10,title:10},C={critical:-80,high:-10,low:20};function ye(e){let n=100;const t=e.tagPriority;return typeof t=="number"?t:(e.tag==="meta"?(e.props["http-equiv"]==="content-security-policy"&&(n=-30),e.props.charset&&(n=-20),e.props.name==="viewport"&&(n=-15)):e.tag==="link"&&e.props.rel==="preconnect"?n=20:e.tag in P&&(n=P[e.tag]),typeof t=="string"&&t in C?n+C[t]:n)}const me=[{prefix:"before:",offset:-1},{prefix:"after:",offset:1}],ge=["onload","onerror","onabort","onprogress","onloadstart"],y="%separator";function Y(e,n,t){if(typeof e!="string"||!e.includes("%"))return e;function o(c){let l;return["s","pageTitle"].includes(c)?l=n.pageTitle:c.includes(".")?l=c.split(".").reduce((m,f)=>m&&m[f]||void 0,n):l=n[c],typeof l<"u"?(l||"").replace(/"/g,'\\"'):!1}let r=e;try{r=decodeURI(e)}catch{}return(r.match(/%(\w+\.+\w+)|%(\w+)/g)||[]).sort().reverse().forEach(c=>{const l=o(c.slice(1));typeof l=="string"&&(e=e.replace(new RegExp(`\\${c}(\\W|$)`,"g"),(m,f)=>`${l}${f}`).trim())}),e.includes(y)&&(e.endsWith(y)&&(e=e.slice(0,-y.length).trim()),e.startsWith(y)&&(e=e.slice(y.length).trim()),e=e.replace(new RegExp(`\\${y}\\s*\\${y}`,"g"),y),e=Y(e,{separator:t},t)),e}async function Z(e){const n={tag:e.tagName.toLowerCase(),props:await j(e.getAttributeNames().reduce((t,o)=>({...t,[o]:e.getAttribute(o)}),{})),innerHTML:e.innerHTML};return n._d=J(n),n}async function ee(e,n={}){var w;const t=n.document||e.resolvedOptions.document;if(!t)return;const o={shouldRender:e.dirty,tags:[]};if(await e.hooks.callHook("dom:beforeRender",o),!o.shouldRender)return;const r=(await e.resolveTags()).map(i=>({tag:i,id:T.includes(i.tag)?H(i):i.tag,shouldRender:!0}));let s=e._dom;if(!s){s={elMap:{htmlAttrs:t.documentElement,bodyAttrs:t.body}};for(const i of["body","head"]){const a=(w=t==null?void 0:t[i])==null?void 0:w.children;for(const d of[...a].filter(p=>T.includes(p.tagName.toLowerCase())))s.elMap[d.getAttribute("data-hid")||H(await Z(d))]=d}}s.pendingSideEffects={...s.sideEffects||{}},s.sideEffects={};function c(i,a,d){const p=`${i}:${a}`;s.sideEffects[p]=d,delete s.pendingSideEffects[p]}function l({id:i,$el:a,tag:d}){const p=d.tag.endsWith("Attrs");s.elMap[i]=a,p||(["textContent","innerHTML"].forEach(u=>{d[u]&&d[u]!==a[u]&&(a[u]=d[u])}),c(i,"el",()=>{s.elMap[i].remove(),delete s.elMap[i]})),Object.entries(d.props).forEach(([u,g])=>{const v=`attr:${u}`;if(u==="class")for(const h of(g||"").split(" ").filter(Boolean))p&&c(i,`${v}:${h}`,()=>a.classList.remove(h)),!a.classList.contains(h)&&a.classList.add(h);else a.getAttribute(u)!==g&&a.setAttribute(u,g===!0?"":String(g)),p&&c(i,v,()=>a.removeAttribute(u))})}const m=[],f={bodyClose:void 0,bodyOpen:void 0,head:void 0};for(const i of r){const{tag:a,shouldRender:d,id:p}=i;if(d){if(a.tag==="title"){t.title=a.textContent;continue}i.$el=i.$el||s.elMap[p],i.$el?l(i):T.includes(a.tag)&&m.push(i)}}for(const i of m){const a=i.tag.tagPosition||"head";i.$el=t.createElement(i.tag.tag),l(i),f[a]=f[a]||t.createDocumentFragment(),f[a].appendChild(i.$el)}for(const i of r)await e.hooks.callHook("dom:renderTag",i,t,c);f.head&&t.head.appendChild(f.head),f.bodyOpen&&t.body.insertBefore(f.bodyOpen,t.body.firstChild),f.bodyClose&&t.body.appendChild(f.bodyClose),Object.values(s.pendingSideEffects).forEach(i=>i()),e._dom=s,e.dirty=!1,await e.hooks.callHook("dom:rendered",{renders:r})}async function te(e,n={}){const t=n.delayFn||(o=>setTimeout(o,10));return e._domUpdatePromise=e._domUpdatePromise||new Promise(o=>t(async()=>{await ee(e,n),delete e._domUpdatePromise,o()}))}function he(e){return n=>{var o,r;const t=((r=(o=n.resolvedOptions.document)==null?void 0:o.head.querySelector('script[id="unhead:payload"]'))==null?void 0:r.innerHTML)||!1;return t&&n.push(JSON.parse(t)),{mode:"client",hooks:{"entries:updated":function(s){te(s,e)}}}}}const ne=I.startsWith("3");function oe(e){return typeof e=="function"?e():M(e)}function b(e,n=""){if(e instanceof Promise)return e;const t=oe(e);return!e||!t?t:Array.isArray(t)?t.map(o=>b(o,n)):typeof t=="object"?Object.fromEntries(Object.entries(t).map(([o,r])=>o==="titleTemplate"||o.startsWith("on")?[o,M(r)]:[o,b(r,o)])):t}const re={hooks:{"entries:resolve":function(e){for(const n of e.entries)n.resolvedInput=b(n.input)}}},L="usehead";function ie(e){return{install(t){ne&&(t.config.globalProperties.$unhead=e,t.config.globalProperties.$head=e,t.provide(L,e))}}.install}function be(e={}){e.domDelayFn=e.domDelayFn||(t=>$(()=>setTimeout(()=>t(),0)));const n=S(e);return n.use(re),n.install=ie(n),n}const E=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_="__unhead_injection_handler__";function se(){if(_ in E)return E[_]();const e=D(L);return e||O()}function Te(e,n={}){const t=n.head||se();if(t)return t.ssr?t.push(e,n):ae(t,e,n)}function ae(e,n,t={}){const o=A(!1),r=A({});R(()=>{r.value=o.value?{}:b(n)});const s=e.push(r.value,t);return U(r,l=>{s.patch(l)}),W()&&(B(()=>{s.dispose()}),N(()=>{o.value=!0}),q(()=>{o.value=!1})),s}export{he as D,T as H,fe as I,ge as N,me as S,ye as a,be as c,de as d,G as h,pe as n,Y as p,ue as r,J as t,Te as u};
