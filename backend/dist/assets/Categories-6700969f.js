import{d as H,Q as W,r as h,a as r,o as C,c as w,i as F,h as v,F as P,k as m,t as f,b as e,w as l,g as c,x as B,y as D,v as q,e as X,G as Y,f as Z,P as ee}from"./index-77affbdd.js";import{n as R}from"./rules-ba8775fb.js";import{a as le,d as ae,u as te,c as ne,g as oe}from"./categories-9e81e093.js";import"./index-26e040f7.js";const se={class:"w-100 px-2 py-1 border d-flex align-center rounded justify-space-between mb-1"},ue={class:"d-flex gap-1"},de={class:"pl-4"},ce={class:"w-100 px-2 py-1 border d-flex align-center rounded justify-space-between mb-1"},ie={class:"d-flex gap-1"},re={class:"pl-4"},ve={class:"w-100 px-2 py-1 border d-flex align-center rounded justify-space-between mb-1"},me={class:"d-flex gap-1"},fe=H({__name:"tree",props:{items:{},locale:{}},emits:["addItem","editItem","deleteItem"],setup(S,{emit:I}){const V=S,{items:$,locale:y}=W(V),g=h(null),i=h(null);return(s,z)=>{const t=r("v-icon"),o=r("v-btn");return C(!0),w(P,null,F(v($),(b,d)=>{var x,N;return C(),w("div",null,[m("div",se,[m("span",null,f(b[`name_${v(y)}`])+" ("+f((x=b.children)==null?void 0:x.length)+")",1),m("div",ue,[e(o,{onClick:u=>s.$emit("addItem",[d],b.id),color:"light-blue-accent-4",size:"30",flat:""},{default:l(()=>[e(t,null,{default:l(()=>[c("mdi-plus")]),_:1})]),_:2},1032,["onClick"]),e(o,{onClick:u=>s.$emit("editItem",b,[d]),color:"light-blue-accent-4",size:"30",flat:""},{default:l(()=>[e(t,null,{default:l(()=>[c("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),e(o,{onClick:u=>s.$emit("deleteItem",b,[d]),color:"light-blue-accent-4",size:"30",flat:""},{default:l(()=>[e(t,null,{default:l(()=>[c("mdi-delete")]),_:1})]),_:2},1032,["onClick"]),B(e(o,{onClick:u=>g.value=g.value===d?null:d,color:"light-blue-accent-4",size:"30",flat:""},{default:l(()=>[e(t,null,{default:l(()=>[c("mdi-"+f(g.value===d?"chevron-up":"chevron-down"),1)]),_:2},1024)]),_:2},1032,["onClick"]),[[D,((N=b.children)==null?void 0:N.length)!==0]])])]),g.value===d?(C(!0),w(P,{key:0},F(b.children,(u,_)=>{var O,T;return C(),w("div",de,[m("div",ce,[m("span",null,f(u[`name_${v(y)}`])+" ("+f((O=u==null?void 0:u.children)==null?void 0:O.length)+")",1),m("div",ie,[e(o,{onClick:a=>s.$emit("addItem",[d,_],u.id),color:"light-blue-accent-4",size:"30",flat:""},{default:l(()=>[e(t,null,{default:l(()=>[c("mdi-plus")]),_:1})]),_:2},1032,["onClick"]),e(o,{onClick:a=>s.$emit("editItem",u,[d,_]),color:"light-blue-accent-4",size:"30",flat:""},{default:l(()=>[e(t,null,{default:l(()=>[c("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),e(o,{onClick:a=>s.$emit("deleteItem",u,[d,_]),color:"light-blue-accent-4",size:"30",flat:""},{default:l(()=>[e(t,null,{default:l(()=>[c("mdi-delete")]),_:1})]),_:2},1032,["onClick"]),B(e(o,{onClick:a=>i.value=i.value===_?null:_,color:"light-blue-accent-4",size:"30",flat:""},{default:l(()=>[e(t,null,{default:l(()=>[c("mdi-"+f(i.value===_?"chevron-up":"chevron-down"),1)]),_:2},1024)]),_:2},1032,["onClick"]),[[D,((T=u.children)==null?void 0:T.length)!==0]])])]),i.value===_?(C(!0),w(P,{key:0},F(u.children,(a,n)=>(C(),w("div",re,[m("div",ve,[m("span",null,f(a[`name_${v(y)}`]),1),m("div",me,[e(o,{onClick:U=>s.$emit("editItem",a,[d,_,n]),color:"light-blue-accent-4",size:"30",flat:""},{default:l(()=>[e(t,null,{default:l(()=>[c("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),e(o,{onClick:U=>s.$emit("deleteItem",a,[d,_,n]),color:"light-blue-accent-4",size:"30",flat:""},{default:l(()=>[e(t,null,{default:l(()=>[c("mdi-delete")]),_:1})]),_:2},1032,["onClick"])])])]))),256)):q("",!0)])}),256)):q("",!0)])}),256)}}}),_e={class:"font-weight-light"},ye=H({__name:"Categories",setup(S){const{t:I,locale:V}=X(),$=h(!1),y=h(!1),g=h(null);h("");const i=h(!1),s=h([]),z=h([]),t=h([]),o=h({parent:null,name_uz:"",name_ru:"",name_en:"",children:[]}),b={parent:null,name_uz:"",name_ru:"",name_en:""};Y(i,a=>a||u());const d=(a,n)=>{o.value.parent=n,t.value=a,i.value=!0},x=(a,n)=>{t.value=n,g.value=a.id,o.value=Object.assign({},a),i.value=!0},N=async(a,n)=>{confirm("Do you delete this item?")&&(n.length===1&&s.value.splice(n[0],1),n.length===2&&s.value[n[0]].children.splice(n[1],1),n.length===3&&s.value[n[0]].children[n[1]].children.splice(n[2],1),await ae(a.id))},u=()=>{i.value=!1,ee(()=>{o.value=Object.assign({},b),g.value=null,t.value=[]})},_=async()=>{if(y.value=!0,g.value!==null){const{data:a}=await te(o.value.id,o.value);a.children&&delete a.children,t.value.length===1&&Object.assign(s.value[t.value[0]],a),t.value.length===2&&Object.assign(s.value[t.value[0]].children[t.value[1]],a),t.value.length===3&&Object.assign(s.value[t.value[0]].children[t.value[1]].children[t.value[2]],a)}else{const{data:a}=await ne(o.value);console.log(a),z.value.push(a),t.value.length===0&&s.value.push({...a,children:[]}),t.value.length===1&&s.value[t.value[0]].children.push({...a,children:[]}),t.value.length===2&&s.value[t.value[0]].children[t.value[1]].children.push({...a,children:[]}),t.value.length===3&&s.value[t.value[0]].children[t.value[1]].children[t.value[2]].children.push({...a,children:[]})}y.value=!1,u()},O=async()=>{$.value=!0;const{data:a}=await oe();a&&(s.value=a,$.value=!1)};return(async()=>{const[a,n]=await Promise.all([le(""),O()]);z.value=a.data.results})(),(a,n)=>{const U=r("v-icon"),A=r("v-btn"),k=r("v-col"),G=r("v-card-title"),L=r("v-card-text"),Q=r("v-card"),j=r("v-row"),E=r("v-text-field"),J=r("v-select"),K=r("v-dialog"),M=r("v-container");return C(),Z(M,{fluid:""},{default:l(()=>[e(j,{justify:"space-between",align:"center"},{default:l(()=>[e(k,{cols:"12",class:"pb-0 d-flex justify-end"},{default:l(()=>[e(A,{onClick:n[0]||(n[0]=p=>i.value=!0),flat:"",color:"primary",size:"43",width:"100%"},{default:l(()=>[e(U,null,{default:l(()=>[c("mdi-plus")]),_:1})]),_:1})]),_:1}),e(k,{cols:"12"},{default:l(()=>[e(Q,{flat:"",border:""},{default:l(()=>[e(G,{class:"px-4 pt-3 font-weight-light"},{default:l(()=>[c(f(v(I)("products.categories")),1)]),_:1}),e(L,null,{default:l(()=>[B(m("span",null,f(a.$t("no_data")),513),[[D,s.value.length===0&&!$.value]]),B(m("span",null,f(a.$t("loading"))+"...",513),[[D,$.value]]),e(fe,{onAddItem:d,onEditItem:x,onDeleteItem:N,items:s.value,locale:v(V)},null,8,["items","locale"])]),_:1})]),_:1})]),_:1})]),_:1}),e(K,{persistent:"",modelValue:i.value,"onUpdate:modelValue":n[6]||(n[6]=p=>i.value=p),"max-width":"500px",transition:"fade-transition"},{default:l(()=>[e(Q,{flat:"",border:"",color:"background"},{default:l(()=>[e(G,{class:"px-4 py-3 d-flex justify-space-between align-center"},{default:l(()=>[m("span",_e,f(v(I)(g.value?"admin.edit_categories":"admin.add_categories")),1),e(A,{flat:"",onClick:n[1]||(n[1]=p=>i.value=!1),size:"32",color:"primary"},{default:l(()=>[e(U,{size:"small"},{default:l(()=>[c("mdi-close")]),_:1})]),_:1})]),_:1}),e(L,{class:"px-4 pt-2 pb-3"},{default:l(()=>[e(j,{class:"pa-2"},{default:l(()=>[e(k,{cols:"12",class:"pa-2"},{default:l(()=>[e(E,{modelValue:o.value.name_uz,"onUpdate:modelValue":n[2]||(n[2]=p=>o.value.name_uz=p),rules:v(R),placeholder:"Nomi (uz)","hide-details":"",density:"compact","bg-color":"surface",color:"primary",variant:"solo",flat:"",class:"border rounded"},null,8,["modelValue","rules"])]),_:1}),e(k,{cols:"12",class:"pa-2"},{default:l(()=>[e(E,{modelValue:o.value.name_ru,"onUpdate:modelValue":n[3]||(n[3]=p=>o.value.name_ru=p),rules:v(R),placeholder:"Название (ru)","hide-details":"",density:"compact","bg-color":"surface",color:"primary",variant:"solo",flat:"",class:"border rounded"},null,8,["modelValue","rules"])]),_:1}),e(k,{cols:"12",class:"pa-2"},{default:l(()=>[e(E,{modelValue:o.value.name_en,"onUpdate:modelValue":n[4]||(n[4]=p=>o.value.name_en=p),rules:v(R),placeholder:"Title (en)","hide-details":"",density:"compact","bg-color":"surface",color:"primary",variant:"solo",flat:"",class:"border rounded"},null,8,["modelValue","rules"])]),_:1}),e(k,{cols:"12",class:"pa-2"},{default:l(()=>[e(J,{modelValue:o.value.parent,"onUpdate:modelValue":n[5]||(n[5]=p=>o.value.parent=p),items:z.value,"item-title":`name_${v(V)}`,"item-value":"id",placeholder:v(I)("admin.parent_category"),"hide-details":"",density:"compact","bg-color":"surface",color:"primary",variant:"solo",flat:"",class:"border rounded"},null,8,["modelValue","items","item-title","placeholder"])]),_:1}),e(k,{cols:"12",class:"pa-2"},{default:l(()=>[e(A,{color:"primary",disabled:y.value,block:"",onClick:_,height:"45"},{default:l(()=>[c(f(v(I)("admin.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}});export{ye as default};
