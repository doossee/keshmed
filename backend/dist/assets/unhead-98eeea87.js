import{c as P}from"./hookable-e7fd869b.js";import{D as $,I as E,d as u,t as k,a as g,H as w,h as y,N as H,S as C,p as h,r as m,n as b}from"./@unhead-e9381f0c.js";const M=["templateParams","htmlAttrs","bodyAttrs"],L=u({hooks:{"tag:normalise":function({tag:n}){["hid","vmid","key"].forEach(t=>{n.props[t]&&(n.key=n.props[t],delete n.props[t])});const s=k(n)||(n.key?`${n.tag}:${n.key}`:!1);s&&(n._d=s)},"tags:resolve":function(n){const e={};n.tags.forEach(t=>{const i=(t.key?`${t.tag}:${t.key}`:t._d)||t._p,a=e[i];if(a){let p=t==null?void 0:t.tagDuplicateStrategy;if(!p&&M.includes(t.tag)&&(p="merge"),p==="merge"){const o=a.props;["class","style"].forEach(r=>{o[r]&&(t.props[r]?(r==="style"&&!o[r].endsWith(";")&&(o[r]+=";"),t.props[r]=`${o[r]} ${t.props[r]}`):t.props[r]=o[r])}),e[i].props={...o,...t.props};return}else if(t._e===a._e){a._duped=a._duped||[],t._d=`${a._d}:${a._duped.length+1}`,a._duped.push(t);return}else if(g(t)>g(a))return}const d=Object.keys(t.props).length+(t.innerHTML?1:0)+(t.textContent?1:0);if(w.includes(t.tag)&&d===0){delete e[i];return}e[i]=t});const s=[];Object.values(e).forEach(t=>{const i=t._duped;delete t._duped,s.push(t),i&&s.push(...i)}),n.tags=s,n.tags=n.tags.filter(t=>!(t.tag==="meta"&&(t.props.name||t.props.property)&&!t.props.content))}}}),A=u({mode:"server",hooks:{"tags:resolve":function(n){const e={};n.tags.filter(s=>["titleTemplate","templateParams","title"].includes(s.tag)&&s._m==="server").forEach(s=>{e[s.tag]=s.tag.startsWith("title")?s.textContent:s.props}),Object.keys(e).length&&n.tags.push({tag:"script",innerHTML:JSON.stringify(e),props:{id:"unhead:payload",type:"application/json"}})}}}),I=["script","link","bodyAttrs"];function j(n){const e={},s={};return Object.entries(n.props).forEach(([t,i])=>{t.startsWith("on")&&typeof i=="function"?(H.includes(t)&&(e[t]=`this.dataset.${t} = true`),s[t]=i):e[t]=i}),{props:e,eventHandlers:s}}const S=u(n=>({hooks:{"tags:resolve":function(e){for(const s of e.tags)if(I.includes(s.tag)){const{props:t,eventHandlers:i}=j(s);s.props=t,Object.keys(i).length&&((s.props.src||s.props.href)&&(s.key=s.key||y(s.props.src||s.props.href)),s._eventHandlers=i)}},"dom:renderTag":function(e,s,t){if(!e.tag._eventHandlers)return;const i=e.tag.tag==="bodyAttrs"?s.defaultView:e.$el;Object.entries(e.tag._eventHandlers).forEach(([a,d])=>{const p=`${e.tag._d||e.tag._p}:${a}`,o=a.slice(2).toLowerCase(),r=`data-h-${o}`;if(t(e.id,p,()=>{}),e.$el.hasAttribute(r))return;e.$el.setAttribute(r,"");let l;const c=f=>{d(f),l==null||l.disconnect()};a in e.$el.dataset?c(new Event(a.replace("on",""))):H.includes(a)&&typeof MutationObserver<"u"?(l=new MutationObserver(f=>{f.some(_=>_.attributeName===`data-${a}`)&&(c(new Event(a.replace("on",""))),l==null||l.disconnect())}),l.observe(e.$el,{attributes:!0})):i.addEventListener(o,c),t(e.id,p,()=>{l==null||l.disconnect(),i.removeEventListener(o,c),e.$el.removeAttribute(r)})})}}})),K=["link","style","script","noscript"],D=u({hooks:{"tag:normalise":({tag:n})=>{n.key&&K.includes(n.tag)&&(n.props["data-hid"]=n._h=y(n.key))}}}),O=u({hooks:{"tags:resolve":n=>{const e=s=>{var t;return(t=n.tags.find(i=>i._d===s))==null?void 0:t._p};for(const{prefix:s,offset:t}of C)for(const i of n.tags.filter(a=>typeof a.tagPriority=="string"&&a.tagPriority.startsWith(s))){const a=e(i.tagPriority.replace(s,""));typeof a<"u"&&(i._p=a+t)}n.tags.sort((s,t)=>s._p-t._p).sort((s,t)=>g(s)-g(t))}}}),N={meta:"content",link:"href",htmlAttrs:"lang"},W=u(n=>({hooks:{"tags:resolve":e=>{var p;const{tags:s}=e,t=(p=s.find(o=>o.tag==="title"))==null?void 0:p.textContent,i=s.findIndex(o=>o.tag==="templateParams"),a=i!==-1?s[i].props:{},d=a.separator||"|";delete a.separator,a.pageTitle=h(a.pageTitle||t||"",a,d);for(const o of s.filter(r=>r.processTemplateParams!==!1)){const r=N[o.tag];r&&typeof o.props[r]=="string"?o.props[r]=h(o.props[r],a,d):(o.processTemplateParams===!0||["titleTemplate","title"].includes(o.tag))&&["innerHTML","textContent"].forEach(l=>{typeof o[l]=="string"&&(o[l]=h(o[l],a,d))})}n._templateParams=a,n._separator=d,e.tags=s.filter(o=>o.tag!=="templateParams")}}})),R=u({hooks:{"tags:resolve":n=>{const{tags:e}=n;let s=e.findIndex(i=>i.tag==="titleTemplate");const t=e.findIndex(i=>i.tag==="title");if(t!==-1&&s!==-1){const i=m(e[s].textContent,e[t].textContent);i!==null?e[t].textContent=i||e[t].textContent:delete e[t]}else if(s!==-1){const i=m(e[s].textContent);i!==null&&(e[s].textContent=i,e[s].tag="title",s=-1)}s!==-1&&delete e[s],n.tags=e.filter(Boolean)}}}),B=u({hooks:{"tags:afterResolve":function(n){for(const e of n.tags)typeof e.innerHTML=="string"&&(e.innerHTML&&["application/ld+json","application/json"].includes(e.props.type)?e.innerHTML=e.innerHTML.replace(/</g,"\\u003C"):e.innerHTML=e.innerHTML.replace(new RegExp(`</${e.tag}`,"g"),`<\\/${e.tag}`))}}});let T;function U(n={}){const e=V(n);return e.use($()),T=e}function v(n,e){return!n||n==="server"&&e||n==="client"&&!e}function V(n={}){const e=P();e.addHooks(n.hooks||{}),n.document=n.document||(E?document:void 0);const s=!n.document,t=()=>{p.dirty=!0,e.callHook("entries:updated",p)};let i=0,a=[];const d=[],p={plugins:d,dirty:!1,resolvedOptions:n,hooks:e,headEntries(){return a},use(o){const r=typeof o=="function"?o(p):o;(!r.key||!d.some(l=>l.key===r.key))&&(d.push(r),v(r.mode,s)&&e.addHooks(r.hooks||{}))},push(o,r){r==null||delete r.head;const l={_i:i++,input:o,...r};return v(l.mode,s)&&(a.push(l),t()),{dispose(){a=a.filter(c=>c._i!==l._i),e.callHook("entries:updated",p),t()},patch(c){a=a.map(f=>(f._i===l._i&&(f.input=l.input=c),f)),t()}}},async resolveTags(){const o={tags:[],entries:[...a]};await e.callHook("entries:resolve",o);for(const r of o.entries){const l=r.resolvedInput||r.input;if(r.resolvedInput=await(r.transform?r.transform(l):l),r.resolvedInput)for(const c of await b(r)){const f={tag:c,entry:r,resolvedOptions:p.resolvedOptions};await e.callHook("tag:normalise",f),o.tags.push(f.tag)}}return await e.callHook("tags:beforeResolve",o),await e.callHook("tags:resolve",o),await e.callHook("tags:afterResolve",o),o.tags},ssr:s};return[L,A,S,D,O,W,R,B,...(n==null?void 0:n.plugins)||[]].forEach(o=>p.use(o)),p.hooks.callHook("init",p),p}function X(){return T}export{U as c,X as g};
